<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <title>Untitled</title>
    

  </head>
    
  <body>
  <!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Êù±‰∫¨ÂÖ©‰∫∫‰πãÊóÖ 2026</title>
    
    <!-- Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Êó•Á≥ªÂúìÈ´î & ÁÑ°Ë•ØÁ∑öÈ´î -->
    <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;500;700&family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- FontAwesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Ëá™ÂÆöÁæ©ÈÖçÁΩÆ -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'tokyo-pink': '#FF9CA8',  // Ê´ªËä±Á≤â
                        'tokyo-bg': '#FFF5F7',    // Ê•µÊ∑∫Á≤âËÉåÊôØ
                        'tokyo-dark': '#4A4A4A',  // Ê∑±ÁÅ∞ÊñáÂ≠ó
                        'tokyo-blue': '#89CFF0',  // Êô¥Á©∫Â°îËóç
                    },
                    fontFamily: {
                        sans: ['"Zen Maru Gothic"', '"Noto Sans TC"', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        /* App ÂÑ™ÂåñË®≠ÁΩÆ */
        body { 
            background-color: #FFF5F7; 
            -webkit-tap-highlight-color: transparent;
            overscroll-behavior-y: none;
        }
        /* Èö±ËóèÊç≤Ëª∏ */
        ::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        .app-container {
            max-width: 480px;
            margin: 0 auto;
            min-height: 100vh;
            background-color: transparent;
            position: relative;
            padding-bottom: 80px; /* È†êÁïôÂ∫ïÈÉ®Á©∫Èñì */
        }
        
        /* Ê®°Êì¨Ê©üÁ•®Èã∏ÈΩíÈÇäÁ∑£ */
        .ticket-edge {
            background-image: radial-gradient(circle at 10px 10px, transparent 10px, #fff 11px);
            background-size: 20px 40px;
            background-position: -10px top;
            background-repeat: repeat-y;
        }

        /* È†ÅÈù¢ÂàáÊèõÂãïÁï´ */
        .fade-enter-active, .fade-leave-active { transition: opacity 0.2s ease; }
        .fade-enter-from, .fade-leave-to { opacity: 0; }
    </style>
</head>
<body class="text-tokyo-dark antialiased">

    <div id="app" class="app-container">

        <!-- ================= 1. È†ÅÈ¶ñ Banner Ëàá Tabs ================= -->
        <header class="relative w-full h-[280px] z-0">
            <!-- Banner ÂúñÁâá (Âª∫Ë≠∞Êõ¥ÊèõÁÇ∫ÊÇ®ÁöÑÊù±‰∫¨ÂêàÁÖß) -->
            <img :src="bannerImage" class="w-full h-full object-cover object-center" alt="Tokyo Banner">
            
            <!-- Êº∏Â±§ÈÅÆÁΩ© -->
            <div class="absolute inset-0 bg-gradient-to-t from-black/40 to-transparent"></div>

            <!-- Ê®ôÈ°å -->
            <div class="absolute top-8 left-6 text-white drop-shadow-md">
                <h1 class="text-3xl font-bold tracking-wider">TOKYO<br>TRIP</h1>
                <p class="text-sm opacity-90 font-medium mt-1">2026.02.26 - 03.03</p>
            </div>

            <!-- Êá∏ÊµÆ Tabs (Floating) -->
            <div class="absolute bottom-14 right-4 flex gap-3 z-30">
                <button 
                    v-for="tab in tabs" 
                    :key="tab.id" 
                    @click="currentTab = tab.id"
                    :class="[
                        'w-12 h-12 rounded-full flex items-center justify-center shadow-lg transition-all duration-300 border-2 backdrop-blur-md',
                        currentTab === tab.id 
                        ? 'bg-tokyo-pink border-white text-white scale-110' 
                        : 'bg-white/80 border-white/50 text-tokyo-pink hover:bg-white'
                    ]"
                >
                    <i :class="tab.icon" class="text-lg"></i>
                </button>
            </div>
        </header>

        <!-- ================= 2. ‰∏ªÂÖßÂÆπÂçÄÂ°ä (ÂúìÂºß‰∏äÊãâ) ================= -->
        <main class="relative -mt-10 rounded-t-[40px] bg-tokyo-bg min-h-[calc(100vh-240px)] z-10 shadow-inner overflow-hidden">
            
            <!-- Ë£ùÈ£æÊääÊâã -->
            <div class="w-12 h-1.5 bg-tokyo-pink/30 rounded-full mx-auto mt-3 mb-4"></div>

            <transition name="fade" mode="out-in">
                
                <!-- ====== Tab 1: ÊØèÊó•Ë°åÁ®ãË°® ====== -->
                <div v-if="currentTab === 'itinerary'" key="itinerary">
                    
                    <!-- Êó•ÊúüÈÅ∏ÂñÆ (Ê©´ÂêëÊªëÂãï) -->
                    <div class="flex overflow-x-auto gap-3 px-4 pb-2 sticky top-0 bg-tokyo-bg/95 backdrop-blur z-20 pt-2 no-scrollbar">
                        <button 
                            v-for="(day, index) in tripDates" 
                            :key="index"
                            @click="currentDayIndex = index"
                            :class="[
                                'flex flex-col items-center justify-center min-w-[65px] py-2 rounded-2xl border transition-all',
                                currentDayIndex === index 
                                ? 'bg-tokyo-pink border-tokyo-pink text-white shadow-md transform scale-105' 
                                : 'bg-white border-white text-slate-400'
                            ]"
                        >
                            <span class="text-lg font-bold">{{ day.week }}</span>
                            <span class="text-xs">{{ day.dateDisplay }}</span>
                        </button>
                    </div>

                    <!-- Â§©Ê∞£Ë≥áË®ä Widget -->
                    <div class="px-4 my-4">
                        <div class="bg-gradient-to-r from-blue-100 to-white rounded-2xl p-3 flex items-center justify-between shadow-sm border border-blue-50">
                            <div class="flex items-center gap-3">
                                <i :class="currentWeather.icon" class="text-2xl text-tokyo-blue"></i>
                                <div>
                                    <div class="font-bold text-tokyo-dark">{{ currentWeather.temp }}¬∞C</div>
                                    <div class="text-[10px] text-slate-500">È´îÊÑü {{ currentWeather.feelsLike }}¬∞C</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="text-xs font-bold text-slate-600">Êù±‰∫¨</div>
                                <div class="text-[10px] text-slate-400">{{ currentWeather.desc }}</div>
                            </div>
                        </div>
                    </div>

                    <!-- Ë°åÁ®ãÂàóË°® -->
                    <div class="px-4 pb-24 space-y-2">
                        <!-- Á©∫Ë°åÁ®ãÊèêÁ§∫ -->
                        <div v-if="currentDayItinerary.length === 0" class="text-center py-10 text-slate-400 border-2 border-dashed border-slate-200 rounded-3xl mt-4">
                            <i class="fa-regular fa-calendar-plus text-2xl mb-2"></i>
                            <p class="text-sm">ÈªûÊìäÂè≥‰∏ãËßí + Êñ∞Â¢ûË°åÁ®ã</p>
                        </div>

                        <div v-for="(item, idx) in currentDayItinerary" :key="item.id" class="relative group">
                            
                            <!-- ‰∫§ÈÄöÊôÇÈñìÈ°ØÁ§∫ (ÈÄ£Êé•Á∑ö) -->
                            <div class="flex justify-center items-center py-2 gap-2 opacity-70 relative z-0">
                                <!-- Á¨¨‰∏ÄÂÄãË°åÁ®ãÈ°ØÁ§∫ÂæûÈ£ØÂ∫óÂá∫Áôº -->
                                <div v-if="idx === 0" class="flex items-center gap-1 text-[10px] text-slate-400 bg-white/50 px-2 py-0.5 rounded-full">
                                    <i class="fa-solid fa-bed"></i> 
                                    <span>Âæû {{ hotelName }} Âá∫Áôº</span>
                                </div>
                                
                                <!-- Ë°åÁ®ã‰πãÈñìÁöÑ‰∫§ÈÄö -->
                                <div v-if="idx > 0" class="flex items-center gap-2">
                                    <i :class="getTransportIcon(item.transportType)" class="text-slate-400 text-xs"></i>
                                    <span class="text-[10px] font-bold text-slate-500">{{ item.transportTime }} min</span>
                                </div>
                                
                                <!-- ÂûÇÁõ¥ÈÄ£Êé•Á∑ö -->
                                <div class="h-[20px] w-0.5 bg-slate-300 absolute -top-2 left-1/2 -z-10"></div>
                            </div>

                            <!-- Ë°åÁ®ãÂç°Áâá -->
                            <div 
                                class="bg-white rounded-2xl p-4 shadow-sm border border-slate-50 relative overflow-hidden transition-all active:scale-[0.98]"
                                :class="{'border-l-4 border-l-blue-400 bg-blue-50/30': item.category === 'flight'}"
                                @click="editItem(item, idx)"
                            >
                                <!-- ÊéíÂ∫èÊåâÈàï (App Ê®°Âºè‰∏ã‰ª•ÊåâÈàïÂëàÁèæËºÉÁ©©) -->
                                <div class="absolute right-2 top-2 flex flex-col gap-1 z-10 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity">
                                    <button @click.stop="moveItem(idx, -1)" class="w-6 h-6 bg-slate-100 rounded-full text-slate-400 hover:text-tokyo-pink flex items-center justify-center"><i class="fa-solid fa-chevron-up text-xs"></i></button>
                                    <button @click.stop="moveItem(idx, 1)" class="w-6 h-6 bg-slate-100 rounded-full text-slate-400 hover:text-tokyo-pink flex items-center justify-center"><i class="fa-solid fa-chevron-down text-xs"></i></button>
                                </div>

                                <!-- Ëà™Áè≠ÁâπÊÆäÊ®£Âºè -->
                                <div v-if="item.category === 'flight'" class="flex flex-col gap-2">
                                    <div class="flex justify-between items-center text-blue-500 mb-1">
                                        <span class="text-[10px] font-bold border border-blue-200 px-2 py-0.5 rounded-md bg-white">FLIGHT</span>
                                        <i class="fa-solid fa-plane"></i>
                                    </div>
                                    <h3 class="font-bold text-lg text-slate-700">{{ item.name }}</h3>
                                    <p class="text-xs text-slate-500 font-mono">{{ item.time }} | {{ item.notes }}</p>
                                </div>

                                <!-- ‰∏ÄËà¨Ë°åÁ®ãÊ®£Âºè -->
                                <div v-else>
                                    <div class="flex justify-between items-start mb-2">
                                        <span class="text-[10px] px-2 py-1 rounded bg-slate-100 text-slate-500 font-bold tracking-wide">{{ getCategoryLabel(item.category) }}</span>
                                        <span class="font-mono font-bold text-tokyo-pink text-lg">{{ item.time }}</span>
                                    </div>
                                    
                                    <h3 class="font-bold text-lg mb-1 text-slate-800">{{ item.name }}</h3>
                                    
                                    <div class="text-xs text-slate-400 flex flex-wrap gap-3 mb-2">
                                        <span v-if="item.openHours">
                                            <i class="fa-regular fa-clock mr-1"></i>{{ item.openHours }}
                                        </span>
                                        <span v-if="item.ticket">
                                            <i class="fa-solid fa-ticket mr-1 text-yellow-500"></i>{{ item.ticket }}
                                        </span>
                                    </div>
                                    
                                    <p v-if="item.notes" class="text-xs text-slate-600 bg-slate-50 p-2 rounded-lg mt-1 border border-slate-100">
                                        {{ item.notes }}
                                    </p>
                                </div>

                                <!-- Google Map Â∞éËà™ÊåâÈàï -->
                                <button 
                                    @click.stop="openGoogleMaps(item.name)"
                                    class="absolute bottom-3 right-3 w-8 h-8 bg-tokyo-pink text-white rounded-full flex items-center justify-center shadow-md hover:scale-110 transition-transform active:bg-red-400 z-10"
                                >
                                    <i class="fa-solid fa-location-arrow text-xs"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Êñ∞Â¢ûË°åÁ®ã FAB -->
                    <button @click="openAddModal('itinerary')" class="fixed bottom-6 right-6 w-14 h-14 bg-tokyo-pink text-white rounded-full shadow-xl shadow-pink-200 flex items-center justify-center text-2xl hover:scale-105 transition active:scale-95 z-40">
                        <i class="fa-solid fa-plus"></i>
                    </button>
                </div>

                <!-- ====== Tab 2: Ë≥áË®ä ====== -->
                <div v-else-if="currentTab === 'info'" key="info" class="px-4 pb-20 space-y-6">
                    
                    <!-- ÂåØÁéáÊèõÁÆó (È¶ôÊ∏ØÂá∫ÁôºÈ†êË®≠ HKD) -->
                    <div class="bg-white p-5 rounded-3xl shadow-sm">
                        <h3 class="font-bold text-slate-700 mb-4 flex items-center"><i class="fa-solid fa-coins mr-2 text-yellow-500"></i>ÂåØÁéáÊèõÁÆó (‰ªäÊó•: {{ exchangeRate }})</h3>
                        <div class="flex items-center gap-3">
                            <div class="flex-1">
                                <label class="text-[10px] text-slate-400 pl-2 font-bold">Êó•Âπ£ JPY</label>
                                <input type="number" v-model="calcJpy" @input="calculateHome" class="w-full bg-slate-50 rounded-xl p-3 font-mono font-bold outline-none focus:ring-2 ring-tokyo-pink/30 text-lg">
                            </div>
                            <i class="fa-solid fa-arrow-right-arrow-left text-slate-300 mt-4"></i>
                            <div class="flex-1">
                                <label class="text-[10px] text-slate-400 pl-2 font-bold">Ê∏ØÂπ£ HKD</label>
                                <input type="number" v-model="calcHome" @input="calculateJpy" class="w-full bg-slate-50 rounded-xl p-3 font-mono font-bold outline-none focus:ring-2 ring-tokyo-pink/30 text-lg">
                            </div>
                        </div>
                    </div>

                    <!-- Ëà™Áè≠Ë≥áË®ä (ÂéªÁ®ã) -->
                    <div class="bg-white rounded-3xl shadow-sm overflow-hidden relative">
                        <div class="bg-blue-500 p-3 text-white flex justify-between items-center">
                            <span class="font-bold text-sm">ÂéªÁ®ã | NH812 (ANA)</span>
                            <span class="text-xs bg-white/20 px-2 py-0.5 rounded">2026/02/26</span>
                        </div>
                        <div class="p-5 flex justify-between items-center">
                            <div class="text-center">
                                <div class="text-3xl font-black text-slate-700">HKG</div>
                                <div class="text-sm font-bold text-blue-500">10:00</div>
                                <div class="text-[10px] text-slate-400">È¶ôÊ∏Ø T1</div>
                            </div>
                            <div class="flex-1 px-4 flex flex-col items-center">
                                <i class="fa-solid fa-plane text-slate-300 transform rotate-90 mb-1"></i>
                                <div class="w-full h-0.5 bg-slate-200 border-b border-dashed border-slate-300"></div>
                                <div class="text-[10px] text-slate-400 mt-1">4h 10m</div>
                            </div>
                            <div class="text-center">
                                <div class="text-3xl font-black text-slate-700">NRT</div>
                                <div class="text-sm font-bold text-blue-500">15:10</div>
                                <div class="text-[10px] text-slate-400">ÊàêÁî∞ T1</div>
                            </div>
                        </div>
                    </div>

                    <!-- Ëà™Áè≠Ë≥áË®ä (ÂõûÁ®ã) -->
                    <div class="bg-white rounded-3xl shadow-sm overflow-hidden relative">
                        <div class="bg-tokyo-pink p-3 text-white flex justify-between items-center">
                            <span class="font-bold text-sm">ÂõûÁ®ã | NH811 (ANA)</span>
                            <span class="text-xs bg-white/20 px-2 py-0.5 rounded">2026/03/03</span>
                        </div>
                        <div class="p-5 flex justify-between items-center">
                            <div class="text-center">
                                <div class="text-3xl font-black text-slate-700">NRT</div>
                                <div class="text-sm font-bold text-tokyo-pink">18:35</div>
                                <div class="text-[10px] text-slate-400">ÊàêÁî∞ T1</div>
                            </div>
                            <div class="flex-1 px-4 flex flex-col items-center">
                                <i class="fa-solid fa-plane text-slate-300 transform rotate-90 mb-1"></i>
                                <div class="w-full h-0.5 bg-slate-200 border-b border-dashed border-slate-300"></div>
                                <div class="text-[10px] text-slate-400 mt-1">5h 15m</div>
                            </div>
                            <div class="text-center">
                                <div class="text-3xl font-black text-slate-700">HKG</div>
                                <div class="text-sm font-bold text-tokyo-pink">22:50</div>
                                <div class="text-[10px] text-slate-400">È¶ôÊ∏Ø T1</div>
                            </div>
                        </div>
                    </div>

                    <!-- ‰ΩèÂÆøË≥áË®ä -->
                    <div class="bg-white rounded-3xl p-5 shadow-sm">
                        <div class="flex items-start gap-3 mb-3">
                            <div class="w-10 h-10 rounded-full bg-purple-50 flex items-center justify-center text-purple-500 shrink-0">
                                <i class="fa-solid fa-hotel"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-slate-700">{{ hotelName }}</h3>
                                <p class="text-xs text-slate-400">2/26 - 3/3 (5 Êôö)</p>
                            </div>
                        </div>
                        <div class="space-y-3 text-sm text-slate-600 pl-2 border-l-2 border-slate-100 ml-5">
                            <p><i class="fa-solid fa-map-pin w-5 text-center text-slate-300"></i>Êù±‰∫¨ÈÉΩÊ∏ØÂå∫ÂÖ≠Êú¨Êú®</p>
                            <p><i class="fa-solid fa-phone w-5 text-center text-slate-300"></i>+81-3-XXXX-XXXX</p>
                        </div>
                        <button @click="openGoogleMaps(hotelName)" class="w-full bg-slate-50 hover:bg-slate-100 py-2.5 rounded-xl text-slate-600 font-bold mt-4 text-sm transition">
                            <i class="fa-solid fa-location-arrow mr-2 text-tokyo-pink"></i>Â∞éËà™Ëá≥È£ØÂ∫ó
                        </button>
                    </div>

                    <!-- ÁßüËªäËàáÁ∑äÊÄ• -->
                    <div class="grid grid-cols-2 gap-3">
                        <div class="bg-white p-4 rounded-2xl shadow-sm text-center" @click="openGoogleMaps('ÊàêÁî∞Ê©üÂ†¥ÁßüËªä')">
                            <i class="fa-solid fa-car text-2xl text-green-500 mb-2"></i>
                            <div class="font-bold text-sm">ÁßüËªäË≥áË®ä</div>
                            <div class="text-[10px] text-slate-400">ÈªûÊìäÂ∞éËà™</div>
                        </div>
                        <div class="bg-red-50 p-4 rounded-2xl shadow-sm text-center">
                            <i class="fa-solid fa-briefcase-medical text-2xl text-red-500 mb-2"></i>
                            <div class="font-bold text-sm">Á∑äÊÄ•ÈÜ´ÁôÇ</div>
                            <div class="text-[10px] text-red-400 font-bold">119 (ÊïëË≠∑Ëªä) / 110 (Ë≠¶)</div>
                        </div>
                    </div>
                </div>

                <!-- ====== Tab 3: Ë≥ºÁâ©Ê∏ÖÂñÆ ====== -->
                <div v-else-if="currentTab === 'shopping'" key="shopping" class="px-4 pb-24">
                    <div class="grid grid-cols-2 gap-4">
                        <div v-for="(item, idx) in shoppingList" :key="idx" class="bg-white rounded-2xl p-3 shadow-sm flex flex-col items-center relative group">
                            <!-- Âà™Èô§ÊåâÈàï -->
                            <button @click="deleteShoppingItem(idx)" class="absolute top-2 right-2 w-6 h-6 bg-slate-100 rounded-full text-slate-300 hover:bg-red-50 hover:text-red-400 flex items-center justify-center transition"><i class="fa-solid fa-xmark text-xs"></i></button>
                            
                            <!-- ÂúñÁâáÈ†êË¶Ω -->
                            <div class="w-full aspect-square bg-slate-50 rounded-xl mb-3 overflow-hidden flex items-center justify-center text-slate-200 border border-slate-100">
                                <img v-if="item.image" :src="item.image" class="w-full h-full object-cover">
                                <i v-else class="fa-solid fa-image text-3xl"></i>
                            </div>
                            <div class="font-bold text-sm text-center mb-2 line-clamp-1">{{ item.name }}</div>
                            <!-- Checkbox -->
                            <label class="inline-flex items-center gap-2 cursor-pointer">
                                <input type="checkbox" v-model="item.checked" class="w-5 h-5 accent-tokyo-pink rounded border-gray-300">
                                <span class="text-xs text-slate-400">{{ item.checked ? 'Â∑≤Ë≤∑' : 'Êú™Ë≤∑' }}</span>
                            </label>
                        </div>
                    </div>

                    <!-- Êñ∞Â¢ûË≥ºÁâ© FAB -->
                    <button @click="openAddModal('shopping')" class="fixed bottom-6 right-6 w-14 h-14 bg-tokyo-pink text-white rounded-full shadow-xl shadow-pink-200 flex items-center justify-center text-2xl hover:scale-105 transition active:scale-95 z-40">
                        <i class="fa-solid fa-plus"></i>
                    </button>
                </div>

                <!-- ====== Tab 4: Ëä±Ë≤ª ====== -->
                <div v-else-if="currentTab === 'expenses'" key="expenses" class="px-4 pb-24">
                    
                    <!-- Á∏ΩËä±Ë≤ªÁúãÊùø -->
                    <div class="bg-gradient-to-br from-slate-700 to-slate-800 rounded-3xl p-6 text-white mb-6 shadow-lg relative overflow-hidden">
                        <div class="absolute -right-5 -top-5 w-32 h-32 bg-white/10 rounded-full blur-2xl"></div>
                        <div class="text-xs opacity-70 mb-1 font-bold tracking-wider">Á∏ΩËä±Ë≤ª TOTAL (JPY)</div>
                        <div class="text-4xl font-bold font-mono">¬• {{ totalExpenses.toLocaleString() }}</div>
                        <div class="mt-4 flex gap-2 overflow-x-auto text-[10px] no-scrollbar">
                            <span class="px-3 py-1 bg-white/10 rounded-full border border-white/10">ÁèæÈáë: ¬•{{ totalCash.toLocaleString() }}</span>
                            <span class="px-3 py-1 bg-white/10 rounded-full border border-white/10">Âà∑Âç°: ¬•{{ totalCard.toLocaleString() }}</span>
                        </div>
                    </div>

                    <!-- Ëä±Ë≤ªÂàóË°® -->
                    <div class="space-y-3">
                        <div v-for="(expense, idx) in expenses" :key="idx" class="bg-white p-4 rounded-2xl shadow-sm flex items-center justify-between border border-slate-50">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-full bg-slate-50 flex items-center justify-center text-slate-400">
                                    <i :class="getExpenseIcon(expense.category)"></i>
                                </div>
                                <div>
                                    <div class="font-bold text-sm text-slate-700">{{ expense.name }}</div>
                                    <div class="text-[10px] text-slate-400">{{ expense.date }} ¬∑ {{ expense.payment }}</div>
                                </div>
                            </div>
                            <div class="font-bold font-mono text-tokyo-dark">¬•{{ expense.amount }}</div>
                        </div>
                    </div>

                    <!-- Êñ∞Â¢ûËä±Ë≤ª FAB -->
                    <button @click="openAddModal('expenses')" class="fixed bottom-6 right-6 w-14 h-14 bg-tokyo-pink text-white rounded-full shadow-xl shadow-pink-200 flex items-center justify-center text-2xl hover:scale-105 transition active:scale-95 z-40">
                        <i class="fa-solid fa-plus"></i>
                    </button>
                </div>

            </transition>
        </main>

        <!-- ================= ÂΩàÂá∫Ë¶ñÁ™ó (Modal) ================= -->
        <div v-if="showModal" class="fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-black/40 backdrop-blur-sm" @click.self="closeModal">
            
            <div class="bg-white w-full sm:w-[440px] rounded-t-[30px] sm:rounded-3xl p-6 shadow-2xl transition-transform transform translate-y-0 max-h-[90vh] overflow-y-auto">
                <div class="w-12 h-1.5 bg-slate-200 rounded-full mx-auto mb-6"></div>
                
                <h2 class="text-xl font-bold mb-4 text-center text-slate-700">
                    {{ isEditing ? 'Á∑®ËºØ' : 'Êñ∞Â¢û' }}{{ modalTitle }}
                </h2>

                <!-- A. Ë°åÁ®ãË°®ÂñÆ -->
                <div v-if="modalType === 'itinerary'" class="space-y-4">
                    <div class="grid grid-cols-2 gap-3">
                         <div>
                            <label class="text-xs text-slate-400 font-bold ml-1">ÊôÇÈñì</label>
                            <input type="time" v-model="form.time" class="w-full bg-slate-50 p-3 rounded-xl outline-none text-sm font-bold">
                        </div>
                        <div>
                            <label class="text-xs text-slate-400 font-bold ml-1">ÂàÜÈ°û</label>
                            <select v-model="form.category" class="w-full bg-slate-50 p-3 rounded-xl outline-none text-sm">
                                <option value="sightseeing">üì∑ ÊôØÈªû</option>
                                <option value="food">üç¥ ÁæéÈ£ü</option>
                                <option value="shopping">üõçÔ∏è Ë≥ºÁâ©</option>
                                <option value="hotel">üè® ‰ΩèÂÆø</option>
                                <option value="transport">üöÑ ‰∫§ÈÄö</option>
                                <option value="flight">‚úàÔ∏è Ëà™Áè≠</option>
                                <option value="other">‚ú® ÂÖ∂‰ªñ</option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <label class="text-xs text-slate-400 font-bold ml-1">ÂêçÁ®±</label>
                        <input type="text" v-model="form.name" placeholder="‰æãÂ¶ÇÔºöÊ∑∫ËçâÂØ∫" class="w-full bg-slate-50 p-3 rounded-xl outline-none text-sm">
                    </div>
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label class="text-xs text-slate-400 font-bold ml-1">ÁáüÊ•≠ÊôÇÈñì</label>
                            <input type="text" v-model="form.openHours" placeholder="09:00-17:00" class="w-full bg-slate-50 p-3 rounded-xl outline-none text-sm">
                        </div>
                        <div>
                            <label class="text-xs text-slate-400 font-bold ml-1">ÈñÄÁ•®/È†êÁÆó</label>
                            <input type="text" v-model="form.ticket" placeholder="¬•0" class="w-full bg-slate-50 p-3 rounded-xl outline-none text-sm">
                        </div>
                    </div>
                    
                    <!-- ‰∫§ÈÄöÊôÇÈñìË®≠ÂÆö -->
                    <div class="bg-blue-50/50 p-3 rounded-xl border border-blue-50">
                        <label class="text-[10px] text-blue-400 font-bold ml-1 block mb-1">Ë∑ùÈõ¢‰∏äÂÄãÈªûÁöÑ‰∫§ÈÄö</label>
                        <div class="flex gap-2">
                             <select v-model="form.transportType" class="bg-white p-2 rounded-lg outline-none w-1/3 text-xs">
                                <option value="walk">Ê≠•Ë°å</option>
                                <option value="drive">ÈñãËªä</option>
                                <option value="train">Â§ßÁúæÈÅãËº∏</option>
                            </select>
                            <input type="number" v-model="form.transportTime" placeholder="ÂàÜÈêò" class="flex-1 bg-white p-2 rounded-lg outline-none text-sm text-center">
                            <span class="flex items-center text-xs text-slate-400">ÂàÜ</span>
                        </div>
                    </div>

                    <div>
                        <label class="text-xs text-slate-400 font-bold ml-1">ÁâπËâ≤ & ÂÇôË®ª</label>
                        <textarea v-model="form.notes" rows="2" class="w-full bg-slate-50 p-3 rounded-xl outline-none text-sm"></textarea>
                    </div>
                </div>

                <!-- B. Ë≥ºÁâ©Ë°®ÂñÆ -->
                <div v-if="modalType === 'shopping'" class="space-y-4">
                    <div>
                        <label class="text-xs text-slate-400 font-bold ml-1">ÂïÜÂìÅÂêçÁ®±</label>
                        <input type="text" v-model="form.name" class="w-full bg-slate-50 p-3 rounded-xl outline-none">
                    </div>
                    <div>
                        <label class="text-xs text-slate-400 font-bold ml-1">ÂúñÁâá (ÈÅ∏ÊìáÊ™îÊ°à)</label>
                        <input type="file" @change="handleImageUpload" class="w-full bg-slate-50 p-3 rounded-xl text-sm file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-xs file:bg-tokyo-pink file:text-white file:font-bold">
                        <div v-if="form.image" class="mt-2 w-20 h-20 rounded-lg overflow-hidden border border-slate-200">
                            <img :src="form.image" class="w-full h-full object-cover">
                        </div>
                    </div>
                </div>

                <!-- C. Ëä±Ë≤ªË°®ÂñÆ -->
                <div v-if="modalType === 'expenses'" class="space-y-4">
                     <div>
                        <label class="text-xs text-slate-400 font-bold ml-1">Êó•Êúü</label>
                        <select v-model="form.date" class="w-full bg-slate-50 p-3 rounded-xl outline-none text-sm">
                            <option v-for="day in tripDates" :value="day.dateDisplay">{{ day.dateDisplay }}</option>
                        </select>
                    </div>
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label class="text-xs text-slate-400 font-bold ml-1">ÂàÜÈ°û</label>
                            <select v-model="form.category" class="w-full bg-slate-50 p-3 rounded-xl outline-none text-sm">
                                <option value="food">üç¥ È£≤È£ü</option>
                                <option value="transport">üöÑ ‰∫§ÈÄö</option>
                                <option value="shopping">üõçÔ∏è Ë≥ºÁâ©</option>
                                <option value="stay">üè® ‰ΩèÂÆø</option>
                                <option value="ticket">üé´ ÈñÄÁ•®</option>
                                <option value="other">‚ú® ÂÖ∂‰ªñ</option>
                            </select>
                        </div>
                        <div>
                            <label class="text-xs text-slate-400 font-bold ml-1">ÈáëÈ°ç (JPY)</label>
                            <input type="number" v-model="form.amount" class="w-full bg-slate-50 p-3 rounded-xl outline-none text-sm font-bold">
                        </div>
                    </div>
                    <div>
                        <label class="text-xs text-slate-400 font-bold ml-1">ÂêçÁ®±</label>
                        <input type="text" v-model="form.name" class="w-full bg-slate-50 p-3 rounded-xl outline-none text-sm">
                    </div>
                    <div>
                         <label class="text-xs text-slate-400 font-bold ml-1">‰ªòÊ¨æÊñπÂºè</label>
                         <div class="flex gap-4 mt-2">
                             <label class="flex items-center"><input type="radio" value="ÁèæÈáë" v-model="form.payment" class="mr-2 accent-tokyo-pink">ÁèæÈáë</label>
                             <label class="flex items-center"><input type="radio" value="‰ø°Áî®Âç°" v-model="form.payment" class="mr-2 accent-tokyo-pink">‰ø°Áî®Âç°</label>
                         </div>
                    </div>
                </div>

                <!-- ÊåâÈàïÂçÄ -->
                <div class="flex gap-3 mt-8">
                    <button v-if="isEditing" @click="confirmDelete" class="flex-1 bg-red-50 text-red-500 py-3 rounded-xl font-bold transition hover:bg-red-100">Âà™Èô§</button>
                    <button @click="saveItem" class="flex-[2] bg-tokyo-pink text-white py-3 rounded-xl font-bold shadow-lg shadow-pink-200 hover:opacity-90 transition">
                        {{ isEditing ? 'ÂÑ≤Â≠òËÆäÊõ¥' : 'Êñ∞Â¢û' }}
                    </button>
                </div>
            </div>
        </div>

    </div>

    <script>
        const { createApp, ref, reactive, computed } = Vue;

        createApp({
            setup() {
                // 1. Âü∫Êú¨Ë®≠ÂÆö
                const bannerImage = ref('https://images.unsplash.com/photo-1540959733332-eab4deabeeaf?q=80&w=1000&auto=format&fit=crop'); // È†êË®≠Êù±‰∫¨ÂúñÁâá
                const currentTab = ref('itinerary');
                const hotelName = "ÂÖ≠Êú¨Êú®ActÈÖíÂ∫ó";
                
                // Tabs ÂÆöÁæ©
                const tabs = [
                    { id: 'itinerary', icon: 'fa-regular fa-calendar-days' },
                    { id: 'info', icon: 'fa-solid fa-circle-info' },
                    { id: 'shopping', icon: 'fa-solid fa-basket-shopping' },
                    { id: 'expenses', icon: 'fa-solid fa-yen-sign' },
                ];

                // 2. Êó•ÊúüËàáÂ§©Ê∞£
                const tripDates = [
                    { fullDate: '2026-02-26', dateDisplay: '2/26', week: 'Thu' },
                    { fullDate: '2026-02-27', dateDisplay: '2/27', week: 'Fri' },
                    { fullDate: '2026-02-28', dateDisplay: '2/28', week: 'Sat' },
                    { fullDate: '2026-03-01', dateDisplay: '3/1', week: 'Sun' },
                    { fullDate: '2026-03-02', dateDisplay: '3/2', week: 'Mon' },
                    { fullDate: '2026-03-03', dateDisplay: '3/3', week: 'Tue' },
                ];
                const currentDayIndex = ref(0);
                
                // Ê®°Êì¨Â§©Ê∞£Êï∏Êìö (Ëá™ÂãïÊäìÂèñÈúÄÂæåÁ´ØÔºåÊ≠§ÁÇ∫Ê®°Êì¨Êù±‰∫¨‰∫åÊúàÂ§©Ê∞£)
                const weatherMocks = [
                    { temp: 8, feelsLike: 5, icon: 'fa-solid fa-sun text-orange-400', desc: 'Êô¥Êúó' },
                    { temp: 6, feelsLike: 3, icon: 'fa-solid fa-cloud text-slate-400', desc: 'Â§öÈõ≤' },
                    { temp: 5, feelsLike: 2, icon: 'fa-solid fa-cloud-rain text-blue-400', desc: 'Â∞èÈõ®' },
                    { temp: 9, feelsLike: 7, icon: 'fa-solid fa-cloud-sun text-yellow-500', desc: 'Êô¥ÊôÇÂ§öÈõ≤' },
                    { temp: 4, feelsLike: 0, icon: 'fa-solid fa-snowflake text-blue-200', desc: 'ÂæÆÈõ™' },
                    { temp: 10, feelsLike: 8, icon: 'fa-solid fa-sun text-orange-400', desc: 'Êô¥Êúó' },
                ];
                const currentWeather = computed(() => weatherMocks[currentDayIndex.value] || weatherMocks[0]);

                // 3. Ë°åÁ®ãÊï∏Êìö
                const itineraryData = reactive({
                    '2026-02-26': [
                        { id: 1, time: '10:00', category: 'flight', name: 'NH812 È£õÂæÄÊù±‰∫¨', notes: 'HKG T1 -> NRT T1', transportTime: 0, transportType: 'drive' },
                        { id: 2, time: '16:30', category: 'transport', name: 'ÂâçÂæÄÂÖ≠Êú¨Êú®È£ØÂ∫ó', notes: 'Skyliner + Âú∞Èêµ', transportTime: 90, transportType: 'train' },
                        { id: 3, time: '19:00', category: 'food', name: 'È£ØÂ∫óÈôÑËøëÂ±ÖÈÖíÂ±ã', notes: 'ÊÖ∂Á•ùÊäµÈÅî', transportTime: 10, transportType: 'walk' },
                    ],
                    // ÂÖ∂‰ªñÂ§©ÂèØÈ†êË®≠ÁÇ∫Á©∫
                    '2026-02-27': [], '2026-02-28': [], '2026-03-01': [], '2026-03-02': [],
                    '2026-03-03': [
                         { id: 99, time: '18:35', category: 'flight', name: 'NH811 È£õÂæÄÈ¶ôÊ∏Ø', notes: 'NRT T1 -> HKG T1', transportTime: 80, transportType: 'train' }
                    ]
                });

                const currentDayItinerary = computed(() => {
                    const key = tripDates[currentDayIndex.value].fullDate;
                    return itineraryData[key] || [];
                });

                // 4. ÂåØÁéá (Ê∏ØÂπ£ HKD)
                const exchangeRate = 0.052; 
                const calcJpy = ref(1000);
                const calcHome = ref(52); // È†êË®≠È°ØÁ§∫ HKD
                const calculateHome = () => { calcHome.value = (calcJpy.value * exchangeRate).toFixed(1); };
                const calculateJpy = () => { calcJpy.value = Math.round(calcHome.value / exchangeRate); };

                // 5. Ë≥ºÁâ©ËàáËä±Ë≤ª
                const shoppingList = reactive([
                    { name: 'Tokyo Banana', image: null, checked: false },
                    { name: 'Ëó•Â¶ù (ÂêàÂà©‰ªñÂëΩ)', image: null, checked: false }
                ]);
                const expenses = reactive([
                    { category: 'transport', name: 'Ë•øÁìúÂç°ÂÑ≤ÂÄº', date: '2/26', amount: 5000, payment: 'ÁèæÈáë' }
                ]);
                
                const totalExpenses = computed(() => expenses.reduce((sum, item) => sum + parseInt(item.amount||0), 0));
                const totalCash = computed(() => expenses.filter(i => i.payment === 'ÁèæÈáë').reduce((sum, item) => sum + parseInt(item.amount||0), 0));
                const totalCard = computed(() => expenses.filter(i => i.payment === '‰ø°Áî®Âç°').reduce((sum, item) => sum + parseInt(item.amount||0), 0));

                // 6. Modal ÈÇèËºØ
                const showModal = ref(false);
                const modalType = ref('');
                const isEditing = ref(false);
                const editingId = ref(null); // Ê≠§ËôïÁî® index Á∞°Âåñ
                const form = reactive({
                    category: 'sightseeing', time: '10:00', name: '', openHours: '', ticket: '', notes: '', 
                    transportTime: 15, transportType: 'train', image: null, date: '', amount: 0, payment: 'ÁèæÈáë'
                });

                const openAddModal = (type) => {
                    modalType.value = type;
                    isEditing.value = false;
                    showModal.value = true;
                    // Reset Form
                    form.category = type === 'expenses' ? 'food' : 'sightseeing';
                    form.time = '10:00';
                    form.name = ''; form.openHours = ''; form.ticket = ''; form.notes = '';
                    form.transportTime = 15; form.transportType = 'train'; form.image = null;
                    form.date = tripDates[currentDayIndex.value].dateDisplay;
                    form.amount = ''; form.payment = 'ÁèæÈáë';
                };

                const editItem = (item, idx) => {
                    if(currentTab.value !== 'itinerary') return;
                    modalType.value = 'itinerary';
                    isEditing.value = true;
                    editingId.value = idx;
                    showModal.value = true;
                    Object.assign(form, item);
                };

                const closeModal = () => { showModal.value = false; };

                const handleImageUpload = (event) => {
                    const file = event.target.files[0];
                    if (file) { form.image = URL.createObjectURL(file); }
                };

                const saveItem = () => {
                    if (modalType.value === 'itinerary') {
                        const key = tripDates[currentDayIndex.value].fullDate;
                        if (!itineraryData[key]) itineraryData[key] = [];
                        const newItem = { id: Date.now(), ...form };
                        
                        if (isEditing.value) {
                             itineraryData[key][editingId.value] = newItem;
                        } else {
                             itineraryData[key].push(newItem);
                             // Êñ∞Â¢ûÂæåÁ∞°ÂñÆÊéíÂ∫è
                             itineraryData[key].sort((a, b) => a.time.localeCompare(b.time));
                        }
                    } else if (modalType.value === 'shopping') {
                        shoppingList.push({ name: form.name, image: form.image, checked: false });
                    } else if (modalType.value === 'expenses') {
                        expenses.unshift({ ...form });
                    }
                    closeModal();
                };

                const confirmDelete = () => {
                    if(confirm('Á¢∫ÂÆöË¶ÅÂà™Èô§ÂóéÔºüÊ≠§Êìç‰ΩúÁÑ°Ê≥ïÂæ©Âéü„ÄÇ')) {
                        const key = tripDates[currentDayIndex.value].fullDate;
                        itineraryData[key].splice(editingId.value, 1);
                        closeModal();
                    }
                };
                
                const deleteShoppingItem = (idx) => {
                    if(confirm('Âà™Èô§Ê≠§Ë≥ºÁâ©È†ÖÁõÆÔºü')) shoppingList.splice(idx, 1);
                };

                // Ë°åÁ®ãÊéíÂ∫è (‰∏äÁßª/‰∏ãÁßª)
                const moveItem = (idx, direction) => {
                    const key = tripDates[currentDayIndex.value].fullDate;
                    const list = itineraryData[key];
                    const newIndex = idx + direction;
                    if (newIndex >= 0 && newIndex < list.length) {
                        [list[idx], list[newIndex]] = [list[newIndex], list[idx]];
                    }
                };

                // Helper Functions
                const getCategoryLabel = (cat) => {
                    const map = { sightseeing: 'ÊôØÈªû', food: 'ÁæéÈ£ü', shopping: 'Ë≥ºÁâ©', hotel: '‰ΩèÂÆø', transport: '‰∫§ÈÄö', other: 'ÂÖ∂‰ªñ', flight: 'Ëà™Áè≠' };
                    return map[cat] || cat;
                };
                const getTransportIcon = (type) => {
                    const map = { walk: 'fa-solid fa-person-walking', drive: 'fa-solid fa-car', train: 'fa-solid fa-train-subway' };
                    return map[type] || 'fa-solid fa-arrow-right';
                };
                const getExpenseIcon = (cat) => {
                    const map = { food: 'fa-utensils', transport: 'fa-train', shopping: 'fa-bag-shopping', stay: 'fa-bed', ticket: 'fa-ticket', other: 'fa-circle-question' };
                    return 'fa-solid ' + (map[cat] || 'fa-circle');
                };
                const openGoogleMaps = (location) => {
                    const url = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(location + ' Êù±‰∫¨')}`;
                    window.open(url, '_blank');
                };

                return {
                    bannerImage, tabs, currentTab, hotelName,
                    tripDates, currentDayIndex, currentDayItinerary, currentWeather,
                    shoppingList, expenses, totalExpenses, totalCash, totalCard,
                    calcJpy, calcHome, calculateHome, calculateJpy, exchangeRate,
                    showModal, modalType, isEditing, form, modalTitle: computed(() => {
                        if(modalType.value === 'itinerary') return 'Ë°åÁ®ã';
                        if(modalType.value === 'shopping') return 'Ë≥ºÁâ©';
                        return 'Ëä±Ë≤ª';
                    }),
                    openAddModal, editItem, closeModal, handleImageUpload, saveItem, confirmDelete, deleteShoppingItem, moveItem,
                    getCategoryLabel, getTransportIcon, getExpenseIcon, openGoogleMaps
                };
            }
        }).mount('#app');
    </script>
</body>
</html>
    
  </body>
  
</html>
